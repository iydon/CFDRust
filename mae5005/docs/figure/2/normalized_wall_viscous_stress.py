from re import A
import matplotlib.pyplot as plt
import numpy as np


parse = lambda string: np.array(list(map(float, string.split())))

data = {
    0.1: {
        'ua': parse('0.0000000000000000        1.0909381306791617E-002   2.1344085863124262E-002   3.1317701555844457E-002   4.0843783106482651E-002   4.9935835638402155E-002   5.8607298422668985E-002   6.6871528860479437E-002   7.4741786758512341E-002   8.2231218951758001E-002   8.9352844326231293E-002   9.6119539291519493E-002  0.10254402375036588       0.10863884760947079       0.11441637787242563       0.11988878635220933       0.12506803803699701       0.12996588013918742       0.13459383185357549       0.13896317484651249       0.14308494449373671       0.14696992188035246       0.15062862657221723       0.15407131016379066       0.15730795060333999       0.16034824729230376       0.16320161695162497       0.16587719024399156       0.16838380913719780       0.17073002499027956       0.17292409734070330       0.17497399336771782       0.17688738800402531       0.17867166466520698       0.18033391656385914       0.18188094857316631       0.18331927960266564       0.18465514544724435       0.18589450206896402       0.18704302927011809       0.18810613471500523       0.18908895825723246       0.18999637652894824       0.19083300774823647       0.19160321670097097       0.19231111985372995       0.19296059055488685       0.19355526428172073       0.19409854389231460       0.19459360484211799       0.19504340032633657       0.19545066631075364       0.19581792641518597       0.19614749661550665       0.19644148973202580       0.19670181967399128       0.19693020541204581       0.19712817465264279       0.19729706719067105       0.19743803791885817       0.19755205947490431       0.19763992450973467       0.19770224756274010       0.19773946653239505       0.19775184373319069       0.19773946653239505       0.19770224756274010       0.19763992450973467       0.19755205947490431       0.19743803791885817       0.19729706719067105       0.19712817465264279       0.19693020541204581       0.19670181967399128       0.19644148973202580       0.19614749661550665       0.19581792641518597       0.19545066631075364       0.19504340032633657       0.19459360484211799       0.19409854389231460       0.19355526428172073       0.19296059055488685       0.19231111985372995       0.19160321670097097       0.19083300774823647       0.18999637652894824       0.18908895825723246       0.18810613471500523       0.18704302927011809       0.18589450206896402       0.18465514544724435       0.18331927960266564       0.18188094857316631       0.18033391656385914       0.17867166466520698       0.17688738800402531       0.17497399336771782       0.17292409734070330       0.17073002499027956       0.16838380913719780       0.16587719024399156       0.16320161695162497       0.16034824729230376       0.15730795060333999       0.15407131016379066       0.15062862657221723       0.14696992188035246       0.14308494449373671       0.13896317484651249       0.13459383185357549       0.12996588013918742       0.12506803803699701       0.11988878635220933       0.11441637787242565       0.10863884760947079       0.10254402375036588        9.6119539291519507E-002   8.9352844326231307E-002   8.2231218951758014E-002   7.4741786758512355E-002   6.6871528860479451E-002   5.8607298422668999E-002   4.9935835638402169E-002   4.0843783106482658E-002   3.1317701555844464E-002   2.1344085863124262E-002   1.0909381306791619E-002   0.0000000000000000'),
        'un': {
            8: parse('0.0000000000000000       0.12702402363197096       0.17938237098873366       0.19596297823433914       0.19916113482340164       0.19596297823433914       0.17938237098873366       0.12702402363197096        0.0000000000000000'),
            16: parse('0.0000000000000000        7.4999566785044533E-002  0.12552767124507089       0.15787799859965215       0.17747232078223285       0.18863543196713037       0.19454325944925108       0.19730378233595869       0.19809807946733715       0.19730378233595869       0.19454325944925108       0.18863543196713037       0.17747232078223285       0.15787799859965215       0.12552767124507089        7.4999566785044547E-002   0.0000000000000000'),
            32: parse('0.0000000000000000        4.0874980478494416E-002   7.4802403021022965E-002  0.10263067583320047       0.12517606379767382       0.14320883904239926       0.15744186074783514       0.16852202964282284       0.17702480795746189       0.18345173841327150       0.18823066253651211       0.19171815023774738       0.19420352284684378       0.19591378623924577       0.19701878769329451       0.19763596255485022       0.19783413428542460       0.19763596255485022       0.19701878769329451       0.19591378623924577       0.19420352284684378       0.19171815023774738       0.18823066253651211       0.18345173841327150       0.17702480795746189       0.16852202964282284       0.15744186074783514       0.14320883904239923       0.12517606379767382       0.10263067583320046        7.4802403021022965E-002   4.0874980478494416E-002   0.0000000000000000'),
        }
    },
    0.5: {
        'ua': parse('0.0000000000000000        2.3630468090159295E-002   4.6777097793315625E-002   6.9444329295151028E-002   9.1636597428336214E-002  0.11335832900007062       0.13461394012447442       0.15540783356144522       0.17574439606358794       0.19562799573282172       0.21506297938826102       0.23405366994696189       0.25260436381911583       0.27071932831926465       0.28840279909510042       0.30565897757540289       0.32249202843865526       0.33890607710386672       0.35490520724511571       0.37049345833131359       0.38567482319267304       0.40045324561534823       0.41483261796569748       0.42881677884559960       0.44240951078023721       0.45561453793973966       0.46843552389605686       0.48087606941641520       0.49293971029468248       0.50462991522194678       0.51595008369758955       0.52690354398210926       0.53749355109292407       0.54772328484435961       0.55759584793299699       0.56711426406953136       0.57628147615826120       0.58510034452530113       0.59357364519657951       0.60170406822665401       0.60949421607934595       0.61694660206116270       0.62406364880844789       0.63084768682916270       0.63730095310017199       0.64342558972087460       0.64922364262398169       0.65469706034421460       0.65984769284565770       0.66467729040846679       0.66918750257559811       0.67337987716018632       0.67725585931416477       0.68081679065868284       0.68406390847683984       0.68699834496921730       0.68962112657265218       0.69193317334265914       0.69393529839986834       0.69562820744080955       0.69701249831333445       0.69808866065692898       0.69885707560813148       0.69931801557123041       0.69947164405438000       0.69931801557123041       0.69885707560813148       0.69808866065692898       0.69701249831333445       0.69562820744080955       0.69393529839986834       0.69193317334265914       0.68962112657265218       0.68699834496921730       0.68406390847683984       0.68081679065868272       0.67725585931416465       0.67337987716018621       0.66918750257559800       0.66467729040846668       0.65984769284565759       0.65469706034421449       0.64922364262398158       0.64342558972087449       0.63730095310017187       0.63084768682916259       0.62406364880844778       0.61694660206116259       0.60949421607934584       0.60170406822665390       0.59357364519657940       0.58510034452530102       0.57628147615826109       0.56711426406953125       0.55759584793299688       0.54772328484435950       0.53749355109292396       0.52690354398210915       0.51595008369758955       0.50462991522194667       0.49293971029468242       0.48087606941641514       0.46843552389605680       0.45561453793973961       0.44240951078023716       0.42881677884559954       0.41483261796569743       0.40045324561534817       0.38567482319267299       0.37049345833131353       0.35490520724511565       0.33890607710386667       0.32249202843865521       0.30565897757540283       0.28840279909510042       0.27071932831926460       0.25260436381911577       0.23405366994696186       0.21506297938826099       0.19562799573282172       0.17574439606358794       0.15540783356144522       0.13461394012447442       0.11335832900007062        9.1636597428336214E-002   6.9444329295151028E-002   4.6777097793315625E-002   2.3630468090159295E-002   0.0000000000000000'),
        'un': {
            8: parse('0.0000000000000000       0.32419757780281366       0.54064455437141012       0.66396410081115886       0.70392695358593715       0.66396410081115886       0.54064455437141012       0.32419757780281366        0.0000000000000000'),
            16: parse('0.0000000000000000       0.17595602406319036       0.32290712664488469       0.44301208554912685       0.53826040159577215       0.61039584080179354       0.66084943405969943       0.69068450517832503       0.70055583249464870       0.69068450517832503       0.66084943405969931       0.61039584080179343       0.53826040159577204       0.44301208554912674       0.32290712664488458       0.17595602406319030        0.0000000000000000'),
            32: parse('0.0000000000000000        9.1661819128211683E-002  0.17579459570285946       0.25267905629858212       0.32259049213419455       0.38579610710249707       0.44255244391974696       0.49310291322810768       0.53767544946878032       0.57648031609667783       0.60970808124365816       0.63752778327280346       0.66008530381901587       0.67750196390069628       0.68987335653387716       0.69726842700509495       0.69972880958418637       0.69726842700509495       0.68987335653387716       0.67750196390069617       0.66008530381901576       0.63752778327280335       0.60970808124365805       0.57648031609667771       0.53767544946878032       0.49310291322810762       0.44255244391974691       0.38579610710249701       0.32259049213419455       0.25267905629858212       0.17579459570285946        9.1661819128211683E-002   0.0000000000000000'),
        }
    },
    1.0: {
        'ua': parse('0.0000000000000000        2.8858184643299228E-002   5.7229381715553147E-002   8.5114884116452599E-002  0.11251598318763016       0.13943396793480414       0.16587012425132980       0.19182573414362519       0.21730207495893855       0.24230041861592183       0.26682203083847467       0.29086817039331958       0.31444008833176768       0.33753902723613266       0.36016622047124519       0.38232289144152026       0.40401025285402398       0.42522950598798442       0.44598183997118557       0.46626843106368154       0.48609044194926132       0.50544902103509148       0.52434530175995875       0.54278040191152899       0.56075542295303338       0.57827144935978825       0.59532954796594817       0.61193076732188412       0.62807613706257659       0.64376666728740184       0.65900334795168569       0.67378714827039154       0.68811901613430138       0.70199987753904214       0.71543063602730039       0.72841217214456189       0.74094534290870417       0.75303098129376089       0.76466989572816946       0.77586286960780404       0.78661066082408693       0.79691400130746359       0.80677359658651482       0.81619012536297264       0.82516423910289605       0.83369656164425188       0.84178768882113886       0.84943818810487848       0.85664859826219208       0.86341942903066826       0.86975116081171500       0.87564424438118482       0.88109910061784380       0.88611612024985031       0.89069566361939445       0.89483806046564185       0.89854360972611080       0.90181257935660397       0.90464520616980137       0.90704169569261339       0.90900222204237946       0.91052692782198552       0.91161592403396619       0.91226929001364043       0.91248707338132318       0.91226929001364043       0.91161592403396619       0.91052692782198552       0.90900222204237946       0.90704169569261339       0.90464520616980137       0.90181257935660397       0.89854360972611080       0.89483806046564185       0.89069566361939445       0.88611612024985031       0.88109910061784380       0.87564424438118482       0.86975116081171500       0.86341942903066826       0.85664859826219208       0.84943818810487848       0.84178768882113886       0.83369656164425188       0.82516423910289605       0.81619012536297264       0.80677359658651482       0.79691400130746359       0.78661066082408693       0.77586286960780404       0.76466989572816946       0.75303098129376089       0.74094534290870417       0.72841217214456189       0.71543063602730039       0.70199987753904214       0.68811901613430138       0.67378714827039154       0.65900334795168569       0.64376666728740184       0.62807613706257659       0.61193076732188412       0.59532954796594817       0.57827144935978825       0.56075542295303338       0.54278040191152899       0.52434530175995875       0.50544902103509148       0.48609044194926132       0.46626843106368154       0.44598183997118562       0.42522950598798442       0.40401025285402398       0.38232289144152026       0.36016622047124519       0.33753902723613266       0.31444008833176768       0.29086817039331958       0.26682203083847467       0.24230041861592180       0.21730207495893850       0.19182573414362514       0.16587012425132974       0.13943396793480409       0.11251598318763012        8.5114884116452572E-002   5.7229381715553133E-002   2.8858184643299221E-002   0.0000000000000000'),
        'un': {
            8: parse('0.0000000000000000       0.40499269247529424       0.68993432784220887       0.85902041729882583       0.91505431180231689       0.85902041729882572       0.68993432784220887       0.40499269247529424        0.0000000000000000'),
            16: parse('0.0000000000000000       0.21742494918238478       0.40425127931276633       0.56110533913434768       0.68856437495442457       0.78713434739249233       0.85723048759751352       0.89916134014796811       0.91311690585700722       0.89916134014796811       0.85723048759751352       0.78713434739249233       0.68856437495442457       0.56110533913434768       0.40425127931276633       0.21742494918238478        0.0000000000000000'),
            32: parse('0.0000000000000000       0.11253065597354753       0.21733127922379897       0.31448354282248808       0.40406753908003767       0.48616100821281644       0.56083858966235089       0.62817110327669812       0.68822486727659493       0.74106105957474477       0.78673512859908301       0.82529625929411632       0.85678689944303410       0.88124235087236580       0.89869042947610767       0.90915119733347061       0.91263676950009931       0.90915119733347061       0.89869042947610767       0.88124235087236580       0.85678689944303410       0.82529625929411632       0.78673512859908301       0.74106105957474477       0.68822486727659493       0.62817110327669812       0.56083858966235101       0.48616100821281644       0.40406753908003767       0.31448354282248814       0.21733127922379897       0.11253065597354753        0.0000000000000000'),
        }
    },
    5.0: {
        'ua': parse('0.0000000000000000        3.1005748341021745E-002   6.1523215498926205E-002   9.1552401540555814E-002  0.12109330653267243       0.15014593054191719       0.17871027363477029       0.20678633587751100       0.23437411733617766       0.26147361807652802       0.28808483816399949       0.31420777766366992       0.33984243664021807       0.36498881515788506       0.38964691328043538       0.41381673107111855       0.43749826859263108       0.46069152590707868       0.48339650307593884       0.50561320016002365       0.52734161721944361       0.54858175431357070       0.56933361150100348       0.58959718883953105       0.60937248638609876       0.62865950419677330       0.64745824232671001       0.66576870083011819       0.68359087976022981       0.70092477916926643       0.71777039910840867       0.73412773962776423       0.74999680077633890       0.76537758260200628       0.78027008515147922       0.79467430847028153       0.80859025260272066       0.82201791759186127       0.83495730347949848       0.84740841030613390       0.85937123811095006       0.87084578693178749       0.88183205680512178       0.89233004776604163       0.90233975984822745       0.91186119308393154       0.92089434750395827       0.92943922313764571       0.93749582001284770       0.94506413815591783       0.95214417759169234       0.95873593834347648       0.96483942043302928       0.97045462388055137       0.97558154870467229       0.98022019492243928       0.98437056254930755       0.98803265159913012       0.99120646208415020       0.99389199401499351       0.99608924740066174       0.99779822224852743       0.99901891856432934       0.99975133635216928       0.99999547561450897       0.99975133635216928       0.99901891856432945       0.99779822224852743       0.99608924740066174       0.99389199401499351       0.99120646208415031       0.98803265159913023       0.98437056254930766       0.98022019492243939       0.97558154870467229       0.97045462388055137       0.96483942043302928       0.95873593834347637       0.95214417759169234       0.94506413815591772       0.93749582001284759       0.92943922313764560       0.92089434750395815       0.91186119308393143       0.90233975984822734       0.89233004776604152       0.88183205680512167       0.87084578693178738       0.85937123811094995       0.84740841030613379       0.83495730347949837       0.82201791759186116       0.80859025260272055       0.79467430847028142       0.78027008515147911       0.76537758260200617       0.74999680077633879       0.73412773962776412       0.71777039910840856       0.70092477916926632       0.68359087976022970       0.66576870083011808       0.64745824232670979       0.62865950419677319       0.60937248638609853       0.58959718883953083       0.56933361150100326       0.54858175431357059       0.52734161721944339       0.50561320016002353       0.48339650307593873       0.46069152590707863       0.43749826859263102       0.41381673107111849       0.38964691328043533       0.36498881515788500       0.33984243664021802       0.31420777766366986       0.28808483816399949       0.26147361807652797       0.23437411733617766       0.20678633587751100       0.17871027363477032       0.15014593054191722       0.12109330653267245        9.1552401540555814E-002   6.1523215498926212E-002   3.1005748341021745E-002   0.0000000000000000'),
        'un': {
            8: parse('0.0000000000000000       0.43749850748335006       0.74999724218883046       0.93749639674606167       0.99999609986604154       0.93749639674606178       0.74999724218883046       0.43749850748335012        0.0000000000000000'),
            16: parse('0.0000000000000000       0.23437414862386766       0.43749832996564264       0.60937257548590140       0.74999691417887715       0.85937137145822817       0.93749596818040459       0.98437071984314706       0.99999563598991703       0.98437071984314706       0.93749596818040459       0.85937137145822817       0.74999691417887715       0.60937257548590129       0.43749832996564253       0.23437414862386760        0.0000000000000000'),
            32: parse('0.0000000000000000       0.12109331031192766       0.23437412485829182       0.33984244783274903       0.43749828334778867       0.52734163539512757       0.60937250780726726       0.68359090422058544       0.74999682804031498       0.80859028240775033       0.85937127016999448       0.90233979385254059       0.93749585563494942       0.96483945732985932       0.98437060036552915       0.99608928577208411       0.99999551417159416       0.99608928577208400       0.98437060036552915       0.96483945732985932       0.93749585563494942       0.90233979385254059       0.85937127016999448       0.80859028240775022       0.74999682804031487       0.68359090422058533       0.60937250780726726       0.52734163539512746       0.43749828334778862       0.33984244783274897       0.23437412485829176       0.12109331031192765        0.0000000000000000'),
        }
    },
    10.0: {
        'ua': parse('0.0000000000000000        3.1005859374512626E-002   6.1523437499025543E-002   9.1552734373539044E-002  0.12109374999805343       0.15014648437256897       0.17871093749708597       0.20678710937160474       0.23437499999612554       0.26147460937064865       0.28808593749517442       0.31420898436970307       0.33984374999423489       0.36499023436877021       0.38964843749330935       0.41381835936785244       0.43749999999239991       0.46069335936695188       0.48339843749150863       0.50561523436607059       0.52734374999063782       0.54858398436521083       0.56933593748978983       0.58959960936437483       0.60937499998896627       0.62866210936356437       0.64746093748816924       0.66577148436278122       0.68359374998740063       0.70092773436202771       0.71777343748666256       0.73413085936130551       0.74999999998595668       0.76538085936061628       0.78027343748528455       0.79467773435996170       0.80859374998464795       0.82202148435934330       0.83496093748404809       0.84741210935876243       0.85937499998348654       0.87084960935822064       0.88183593748296496       0.89233398435771960       0.90234374998248468       0.91186523435726019       0.92089843748204647       0.92944335935684363       0.93749999998165168       0.94506835935647071       0.95214843748130096       0.95874023435614253       0.96484374998099531       0.97045898435585964       0.97558593748073563       0.98022460935562306       0.98437499998052225       0.98803710935543299       0.99121093748035560       0.99389648435529010       0.99609374998023648       0.99780273435519462       0.99902343748016487       0.99975585935514688       0.99999999998014100       0.99975585935514688       0.99902343748016476       0.99780273435519462       0.99609374998023636       0.99389648435528999       0.99121093748035549       0.98803710935543287       0.98437499998052214       0.98022460935562294       0.97558593748073552       0.97045898435585953       0.96484374998099520       0.95874023435614242       0.95214843748130085       0.94506835935647060       0.93749999998165157       0.92944335935684352       0.92089843748204636       0.91186523435726008       0.90234374998248446       0.89233398435771938       0.88183593748296474       0.87084960935822053       0.85937499998348632       0.84741210935876221       0.83496093748404787       0.82202148435934308       0.80859374998464772       0.79467773435996147       0.78027343748528433       0.76538085936061606       0.74999999998595646       0.73413085936130518       0.71777343748666234       0.70092773436202738       0.68359374998740041       0.66577148436278089       0.64746093748816891       0.62866210936356404       0.60937499998896594       0.58959960936437450       0.56933593748978950       0.54858398436521050       0.52734374999063749       0.50561523436607025       0.48339843749150829       0.46069335936695155       0.43749999999239958       0.41381835936785216       0.38964843749330907       0.36499023436876998       0.33984374999423467       0.31420898436970285       0.28808593749517425       0.26147460937064848       0.23437499999612538       0.20678710937160458       0.17871093749708583       0.15014648437256883       0.12109374999805331        9.1552734373538946E-002   6.1523437499025481E-002   3.1005859374512595E-002   0.0000000000000000'),
        'un': {
            8: parse('0.0000000000000000       0.43749999999435923       0.74999999998957712       0.93749999998638189       0.99999999998525990       0.93749999998638189       0.74999999998957712       0.43749999999435918        0.0000000000000000'),
            16: parse('0.0000000000000000       0.23437499999639994       0.43749999999293826       0.60937499998974798       0.74999999998695155       0.85937499998465661       0.93749999998295130       0.98437499998190114       0.99999999998154676       0.98437499998190137       0.93749999998295153       0.85937499998465683       0.74999999998695166       0.60937499998974798       0.43749999999293826       0.23437499999639996        0.0000000000000000'),
            32: parse('0.0000000000000000       0.12109374999808888       0.23437499999619615       0.33984374999434008       0.43749999999253847       0.52734374999080880       0.60937499998916755       0.68359374998763078       0.74999999998621303       0.80859374998492806       0.85937499998378819       0.90234374998280442       0.93749999998198630       0.96484374998134159       0.98437499998087663       0.99609374998059597       0.99999999998050215       0.99609374998059597       0.98437499998087674       0.96484374998134170       0.93749999998198641       0.90234374998280442       0.85937499998378819       0.80859374998492806       0.74999999998621303       0.68359374998763067       0.60937499998916755       0.52734374999080880       0.43749999999253847       0.33984374999434008       0.23437499999619615       0.12109374999808888        0.0000000000000000'),
        }
    },
}

time = list(data.keys())
analytical = [
    (value['ua'][1]-value['ua'][0]) / (2.0/(len(value['ua'])-1))
    for value in data.values()
]
numericals = {
    grid: [
        (value['un'][grid][1]-value['un'][grid][0]) / (2.0/(len(value['un'][grid])-1))
        for value in data.values()
    ] for grid in data[time[0]]['un'].keys()
}

fig, ax = plt.subplots(1, figsize=(16, 9))
ax.plot(time, analytical, label='Analytical Solution')
for grid, numerical in numericals.items():
    ax.plot(time, numerical, label=f'Numerical Solution (N={grid})')
ax.set_xlabel('Dimensionless Time (νt/L²)')
ax.set_ylabel(r'Normalized Wall Viscous Stress ($\tau^*_w$)')
ax.legend()
ax.grid()
fig.savefig(__file__.replace('.py', '.png'), bbox_inches='tight', transparent=True)
