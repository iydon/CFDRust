\section{第五次作业}

\begin{homework}[label={H:5-1}]
    Consider the 1D advection equation (with $a=1$)
    \begin{equation}\label{E:5-1-1}
        \pdv{u}{t} + a\pdv{u}{x} = 0,
        \quad
        \text{for $0\leq x\leq 2$ and $t\geq 0$},
    \end{equation}
    with the following initial condition and periodic boundary condition
    \begin{equation}\label{E:5-1-2}
        u(x, t=0) = \sin(\pi x) + 0.2\sin(4\pi x),
        \quad
        u(x=0, t) = u(x=2, t).
    \end{equation}

    Namely, the initial condition contains two modes with wavenumbers $k_1=1$ and $k_2=4$. Take the explicit upwind scheme for solving the above 1D advection equation with the solving the above 1D advection equation with the given initial and boundary conditions
    \begin{equation}\label{E:5-1-3}
        \frac{u^{n+1}_j-u^n_j}{\Delta t} + a\frac{u^n_j-u^n_{j-1}}{\Delta x} = 0.
    \end{equation}

    Assume $N$ grid cells are used, namely, $\Delta x=2/N$ and $C\equiv a\Delta t/\Delta x=0.5$. Also, let the node points are located at the center of the cell, namely, $x_i=(i-0.5)\Delta x$, for $i=1,2,\ldots,N$. Hint: For easy coding, you may add one virtual node on each end of the domain.

    \begin{enumerate}[label=(\alph*)]
        \item Find the exact solution $u$ for the system defined by equations~\eqref{E:5-1-1} and \eqref{E:5-1-2}.
        \item In the lecture, we derived the following approximate modified equation for the upwind scheme
            \begin{equation}\label{E:5-1-4}
                \pdv{u}{t}+a\pdv{u}{x} \approx b_2\pdv[2]{u}{x}+b_3\pdv[3]{u}{x}+b_4\pdv[4]{u}{x}
            \end{equation}
            where
            \begin{equation}\label{E:5-1-5}
                \begin{aligned}
                    b_2 &\equiv \frac{a\Delta x}{2}\qty(1-C) \\
                    b_3 &\equiv -\frac{a\Delta x^2}{6}\qty(1-3C+2C^2) \\
                    b_4 &\equiv \frac{a\Delta x^3}{24}\qty(1-7C+12C^2-6C^3)
                \end{aligned}
            \end{equation}
            Obtain the analytical solution for the modified equation, $u_M$, for the same initial and boundary conditions.
        \item Use $N=20$, plot the numerical solution, $u_N$, and the two analytical solutions, $u$ and $u_M$, together, at $t=1.0$ and $t=2.0$, respectively.
        \item Use $N=160$, plot the numerical solution, $u_N$, and the two analytical solutions, $u$ and $u_M$, together, at $t=1.0$ and $t=2.0$, respectively.
    \end{enumerate}
\end{homework}

pass



\begin{homework}[label={H:5-2}]
    Consider the same problem as in Problem~\ref{H:5-1}, $a=1$, and the same initial and boundary conditions. Now we use the Lax-Wendroff scheme
    \begin{equation}\label{E:5-2-1}
        \frac{u^{n+1}_j-u^n_j}{\Delta t} + a\frac{u^n_{j+1}-u^n_{j-1}}{2\Delta x}
        =
        \frac{a^2\Delta t}{2}\frac{\qty(u^n_{j+1}-2u^n_j+u^n_{j-1})}{\Delta x^2}.
    \end{equation}
    again use $C\equiv a\Delta t/\Delta x=0.5$ in the numerical solution below. Note that the code for this problem can be easily developed by modifying slightly the code for Problem~\ref{H:5-1}.

    \begin{enumerate}[label=(\alph*)]
        \item We know from the lecture that the approximate modified partial differential equation for the numerical scheme is
            \begin{equation}\label{E:5-2-2}
                u_t+au_x
                \approx
                -\frac{a\Delta x^2}{6}\qty(1-C^2)u_{xxx} - \frac{a\Delta x^3}{8}C\qty(1-C^2)u_{xxxx},
            \end{equation}
            where $C=a\Delta t/\Delta x$. Find the analytical solution, $u_M$, for this modified equation.
        \item Use $N=20$, plot the numerical solution, $u_N$, and the two analytical solutions, $u$ and $u_M$, together, at $t=1.0$ and $t=2.0$, respectively.
        \item Use $N=160$, plot the numerical solution, $u_N$, and the two analytical solutions, $u$ and $u_M$, together, at $t=1.0$ and $t=2.0$, respectively.   
    \end{enumerate}
\end{homework}

pass



\begin{homework}[label={H:5-3}]
    In this problem, we shall compare the accuracy and numerical stability the upwind scheme (Problem~\ref{H:5-1}) and the Lax-Wendroff scheme (Problem~\ref{H:5-2}).

    \begin{enumerate}[label=(\alph*)]
        \item Compute the L2 errors for both scheme for $N=20, 40, 80, 160$ at $t=1.0$. Then plot the errors, on a same figure as a function of $N$. Here the L2 error is defined as
            \begin{equation}\label{E:5-3-1}
                L2 = \sqrt{
                    \frac{\sum_{i=1}^N\qty(u_N(i)-u(i))^2}{N}
                }
            \end{equation}
            Comment on your result.
        \item Can you use the modified equation of each scheme, to predict the L2 errors you have obtained in part~(a)? Compare the L2 errors you obtained from (a) with those predicted from the respective modified equation, using a table.
        \item Next for both schemes, and with $N=80$, run the code with $C=a\Delta t/\Delta x=0.5, 1.0, 1.2$, plot the L2 error as a function of time to investigate the numerical stability. What are your observations?
    \end{enumerate}
\end{homework}

pass
